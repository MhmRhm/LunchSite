{% load crispy_forms_tags %}

{% block head %}
<link rel="stylesheet" type="text/css" href="https://bootswatch.com/5/darkly/bootstrap.css">
<style>
  form {
    margin: 0;
  }

  .form-container {
    text-align: left;
  }

  .center {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
  }

  th,
  td {
    vertical-align: middle;
  }
</style>
{% endblock %}

{% block content %}

<body>
  <div class="center">
    <h1>{{ menu.name }}</h1>
    <p class="text-light">{{menu.description}}</p>
    <table class="table table-hover">
      <thead>
        <tr class="table-primary">
          <th scope="col">Meal</th>
          <th scope="col">Description</th>
          <th scope="col">Price</th>
          <th scope="col"></th>
        </tr>
      </thead>
      <tbody>
        {% for item in menu_items %}
        <tr class="table-secondary">
          <th scope="row">{{ item.meal.name }}</th>
          <td>{{ item.meal.description }}</td>
          <td>RM {{ item.meal.price }}</td>
          <td>
            {% if is_expired %}
            Expired
            {% else %}
            {% if item.can_order %}
            <form action="{% url 'order_meal' menu.id item.meal.id %}" method="post">
              {% csrf_token %}
              <button type="submit" class="btn btn-success">Order</button>
            </form>
            {% else %}
            <form action="{% url 'cancel_meal' menu.id item.meal.id %}" method="post">
              {% csrf_token %}
              <button type="submit" class="btn btn-danger">Cancel</button>
            </form>
            {% endif %}
            {% endif %}
          </td>
        </tr>
        {% endfor %}
        <tr class="table-active">
          <td scope="col" class="text-body">Credit</td>
          <td scope="col"></td>
          <td scope="col" class="text-body">RM {{ credit }}</td>
          <td scope="col">
            <form action="{% url 'report_menu' menu.id %}" method="post">
              {% csrf_token %}
              <button type="submit" class="btn btn-warning">Report</button>
            </form>
          </td>
        </tr>
      </tbody>
    </table>
    <p class="text-light">Expires at: {{menu.expire_at}}</p>
    <div class="form-container">
      <form action="{% url 'logout' %}" method="post">
        {% csrf_token %}
        <button type="submit" class="btn btn-danger">Log Out</button>
      </form>
    </div>
  </div>
</body>
{% endblock %}